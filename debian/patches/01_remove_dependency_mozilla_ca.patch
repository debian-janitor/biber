Description: remove requirement for Mozilla::CA, Debian has ca-certificates
Origin: vendor
Forwarded: not-needed
Author: Danai SAE-HAN (韓達耐)
Reviewed-by: gregor herrmann <gregoa@debian.org>
Last-Update: 2014-01-07
Comment: fixes to adapt to biber 1.8

---
 lib/Biber/Input/file/biblatexml.pm   |   11 -----------
 lib/Biber/Input/file/bibtex.pm       |   11 -----------
 lib/Biber/Input/file/endnotexml.pm   |   11 -----------
 lib/Biber/Input/file/ris.pm          |   11 -----------
 lib/Biber/Input/file/zoterordfxml.pm |   11 -----------
 5 files changed, 55 deletions(-)

--- biber.orig/lib/Biber/Input/file/biblatexml.pm
+++ biber/lib/Biber/Input/file/biblatexml.pm
@@ -99,17 +99,6 @@
         # use IO::Socket::SSL qw(debug99); # useful for debugging SSL issues
         # We have to explicitly set the cert path because otherwise the https module
         # can't find the .pem when PAR::Packer'ed
-        # Have to explicitly try to require Mozilla::CA here to get it into %INC below
-        # It may, however, have been removed by some biber unpacked dists
-        if (not exists($ENV{PERL_LWP_SSL_CA_FILE}) and
-            not exists($ENV{PERL_LWP_SSL_CA_PATH}) and
-            not defined(Biber::Config->getoption('ssl-nointernalca')) and
-            eval {require Mozilla::CA}) {
-          # we assume that the default CA file is in .../Mozilla/CA/cacert.pem
-          (my $vol, my $dir, undef) = File::Spec->splitpath( $INC{"Mozilla/CA.pm"} );
-          $dir =~ s/\/$//;      # splitpath sometimes leaves a trailing '/'
-          $ENV{PERL_LWP_SSL_CA_FILE} = File::Spec->catpath($vol, "$dir/CA", 'cacert.pem');
-        }
 
         # fallbacks for, e.g., linux
         unless (exists($ENV{PERL_LWP_SSL_CA_FILE})) {
--- biber.orig/lib/Biber/Input/file/endnotexml.pm
+++ biber/lib/Biber/Input/file/endnotexml.pm
@@ -113,17 +113,6 @@
       # use IO::Socket::SSL qw(debug99); # useful for debugging SSL issues
       # We have to explicitly set the cert path because otherwise the https module
       # can't find the .pem when PAR::Packer'ed
-      # Have to explicitly try to require Mozilla::CA here to get it into %INC below
-      # It may, however, have been removed by some biber unpacked dists
-      if (not exists($ENV{PERL_LWP_SSL_CA_FILE}) and
-          not exists($ENV{PERL_LWP_SSL_CA_PATH}) and
-          not defined(Biber::Config->getoption('ssl-nointernalca')) and
-          eval {require Mozilla::CA}) {
-        # we assume that the default CA file is in .../Mozilla/CA/cacert.pem
-        (my $vol, my $dir, undef) = File::Spec->splitpath( $INC{"Mozilla/CA.pm"} );
-        $dir =~ s/\/$//; # splitpath sometimes leaves a trailing '/'
-        $ENV{PERL_LWP_SSL_CA_FILE} = File::Spec->catpath($vol, "$dir/CA", 'cacert.pem');
-      }
 
       # fallbacks for, e.g., linux
       unless (exists($ENV{PERL_LWP_SSL_CA_FILE})) {
--- biber.orig/lib/Biber/Input/file/ris.pm
+++ biber/lib/Biber/Input/file/ris.pm
@@ -112,17 +112,6 @@
         # use IO::Socket::SSL qw(debug99); # useful for debugging SSL issues
         # We have to explicitly set the cert path because otherwise the https module
         # can't find the .pem when PAR::Packer'ed
-        # Have to explicitly try to require Mozilla::CA here to get it into %INC below
-        # It may, however, have been removed by some biber unpacked dists
-        if (not exists($ENV{PERL_LWP_SSL_CA_FILE}) and
-            not exists($ENV{PERL_LWP_SSL_CA_PATH}) and
-            not defined(Biber::Config->getoption('ssl-nointernalca')) and
-            eval {require Mozilla::CA}) {
-          # we assume that the default CA file is in .../Mozilla/CA/cacert.pem
-          (my $vol, my $dir, undef) = File::Spec->splitpath( $INC{"Mozilla/CA.pm"} );
-          $dir =~ s/\/$//;      # splitpath sometimes leaves a trailing '/'
-          $ENV{PERL_LWP_SSL_CA_FILE} = File::Spec->catpath($vol, "$dir/CA", 'cacert.pem');
-        }
 
         # fallbacks for, e.g., linux
         unless (exists($ENV{PERL_LWP_SSL_CA_FILE})) {
--- biber.orig/lib/Biber/Input/file/zoterordfxml.pm
+++ biber/lib/Biber/Input/file/zoterordfxml.pm
@@ -125,17 +125,6 @@
       # use IO::Socket::SSL qw(debug99); # useful for debugging SSL issues
       # We have to explicitly set the cert path because otherwise the https module
       # can't find the .pem when PAR::Packer'ed
-      # Have to explicitly try to require Mozilla::CA here to get it into %INC below
-      # It may, however, have been removed by some biber unpacked dists
-      if (not exists($ENV{PERL_LWP_SSL_CA_FILE}) and
-          not exists($ENV{PERL_LWP_SSL_CA_PATH}) and
-          not defined(Biber::Config->getoption('ssl-nointernalca')) and
-          eval {require Mozilla::CA}) {
-        # we assume that the default CA file is in .../Mozilla/CA/cacert.pem
-        (my $vol, my $dir, undef) = File::Spec->splitpath( $INC{"Mozilla/CA.pm"} );
-        $dir =~ s/\/$//; # splitpath sometimes leaves a trailing '/'
-        $ENV{PERL_LWP_SSL_CA_FILE} = File::Spec->catpath($vol, "$dir/CA", 'cacert.pem');
-      }
 
       # fallbacks for, e.g., linux
       unless (exists($ENV{PERL_LWP_SSL_CA_FILE})) {
--- biber.orig/lib/Biber/Input/file/bibtex.pm
+++ biber/lib/Biber/Input/file/bibtex.pm
@@ -142,17 +142,6 @@
         # use IO::Socket::SSL qw(debug99); # useful for debugging SSL issues
         # We have to explicitly set the cert path because otherwise the https module
         # can't find the .pem when PAR::Packer'ed
-        # Have to explicitly try to require Mozilla::CA here to get it into %INC below
-        # It may, however, have been removed by some biber unpacked dists
-        if (not exists($ENV{PERL_LWP_SSL_CA_FILE}) and
-            not exists($ENV{PERL_LWP_SSL_CA_PATH}) and
-            not defined(Biber::Config->getoption('ssl-nointernalca')) and
-            eval {require Mozilla::CA}) {
-          # we assume that the default CA file is in .../Mozilla/CA/cacert.pem
-          (my $vol, my $dir, undef) = File::Spec->splitpath( $INC{"Mozilla/CA.pm"} );
-          $dir =~ s/\/$//;      # splitpath sometimes leaves a trailing '/'
-          $ENV{PERL_LWP_SSL_CA_FILE} = File::Spec->catpath($vol, "$dir/CA", 'cacert.pem');
-        }
 
         # fallbacks for, e.g., linux
         unless (exists($ENV{PERL_LWP_SSL_CA_FILE})) {
