Description: remove requirement for Mozilla::CA, Debian has ca-certificates
Origin: vendor
Forwarded: not-needed
Author: Danai SAE-HAN (韓達耐)
Reviewed-by: gregor herrmann <gregoa@debian.org>
Last-Update: 2014-01-07
Comment: fixes to adapt to biber 1.8

---
 lib/Biber/Input/file/biblatexml.pm   |    8 ++------
 lib/Biber/Input/file/bibtex.pm       |    8 ++------
 lib/Biber/Input/file/endnotexml.pm   |    8 ++------
 lib/Biber/Input/file/ris.pm          |    8 ++------
 lib/Biber/Input/file/zoterordfxml.pm |    8 ++------
 5 files changed, 10 insertions(+), 30 deletions(-)

--- biber.orig/lib/Biber/Input/file/biblatexml.pm
+++ biber/lib/Biber/Input/file/biblatexml.pm
@@ -99,12 +99,8 @@
       # It may, however, have been removed by some biber unpacked dists
       if (not exists($ENV{PERL_LWP_SSL_CA_FILE}) and
           not exists($ENV{PERL_LWP_SSL_CA_PATH}) and
-          not defined(Biber::Config->getoption('ssl-nointernalca')) and
-          eval {require Mozilla::CA}) {
-        # we assume that the default CA file is in .../Mozilla/CA/cacert.pem
-        (my $vol, my $dir, undef) = File::Spec->splitpath( $INC{"Mozilla/CA.pm"} );
-        $dir =~ s/\/$//; # splitpath sometimes leaves a trailing '/'
-        $ENV{PERL_LWP_SSL_CA_FILE} = File::Spec->catpath($vol, "$dir/CA", 'cacert.pem');
+          not defined(Biber::Config->getoption('ssl-nointernalca'))) {
+        $ENV{PERL_LWP_SSL_CA_FILE} = '/etc/ssl/certs/ca-certificates.crt';
       }
 
       # fallbacks for, e.g., linux
--- biber.orig/lib/Biber/Input/file/endnotexml.pm
+++ biber/lib/Biber/Input/file/endnotexml.pm
@@ -118,12 +118,8 @@
       # It may, however, have been removed by some biber unpacked dists
       if (not exists($ENV{PERL_LWP_SSL_CA_FILE}) and
           not exists($ENV{PERL_LWP_SSL_CA_PATH}) and
-          not defined(Biber::Config->getoption('ssl-nointernalca')) and
-          eval {require Mozilla::CA}) {
-        # we assume that the default CA file is in .../Mozilla/CA/cacert.pem
-        (my $vol, my $dir, undef) = File::Spec->splitpath( $INC{"Mozilla/CA.pm"} );
-        $dir =~ s/\/$//; # splitpath sometimes leaves a trailing '/'
-        $ENV{PERL_LWP_SSL_CA_FILE} = File::Spec->catpath($vol, "$dir/CA", 'cacert.pem');
+          not defined(Biber::Config->getoption('ssl-nointernalca'))) {
+        $ENV{PERL_LWP_SSL_CA_FILE} = '/etc/ssl/certs/ca-certificates.crt';
       }
 
       # fallbacks for, e.g., linux
--- biber.orig/lib/Biber/Input/file/ris.pm
+++ biber/lib/Biber/Input/file/ris.pm
@@ -113,12 +113,8 @@
       # It may, however, have been removed by some biber unpacked dists
       if (not exists($ENV{PERL_LWP_SSL_CA_FILE}) and
           not exists($ENV{PERL_LWP_SSL_CA_PATH}) and
-          not defined(Biber::Config->getoption('ssl-nointernalca')) and
-          eval {require Mozilla::CA}) {
-        # we assume that the default CA file is in .../Mozilla/CA/cacert.pem
-        (my $vol, my $dir, undef) = File::Spec->splitpath( $INC{"Mozilla/CA.pm"} );
-        $dir =~ s/\/$//; # splitpath sometimes leaves a trailing '/'
-        $ENV{PERL_LWP_SSL_CA_FILE} = File::Spec->catpath($vol, "$dir/CA", 'cacert.pem');
+          not defined(Biber::Config->getoption('ssl-nointernalca'))) {
+        $ENV{PERL_LWP_SSL_CA_FILE} = '/etc/ssl/certs/ca-certificates.crt';
       }
 
       # fallbacks for, e.g., linux
--- biber.orig/lib/Biber/Input/file/zoterordfxml.pm
+++ biber/lib/Biber/Input/file/zoterordfxml.pm
@@ -129,12 +129,8 @@
       # It may, however, have been removed by some biber unpacked dists
       if (not exists($ENV{PERL_LWP_SSL_CA_FILE}) and
           not exists($ENV{PERL_LWP_SSL_CA_PATH}) and
-          not defined(Biber::Config->getoption('ssl-nointernalca')) and
-          eval {require Mozilla::CA}) {
-        # we assume that the default CA file is in .../Mozilla/CA/cacert.pem
-        (my $vol, my $dir, undef) = File::Spec->splitpath( $INC{"Mozilla/CA.pm"} );
-        $dir =~ s/\/$//; # splitpath sometimes leaves a trailing '/'
-        $ENV{PERL_LWP_SSL_CA_FILE} = File::Spec->catpath($vol, "$dir/CA", 'cacert.pem');
+          not defined(Biber::Config->getoption('ssl-nointernalca'))) {
+        $ENV{PERL_LWP_SSL_CA_FILE} = '/etc/ssl/certs/ca-certificates.crt';
       }
 
       # fallbacks for, e.g., linux
--- biber.orig/lib/Biber/Input/file/bibtex.pm
+++ biber/lib/Biber/Input/file/bibtex.pm
@@ -140,12 +140,8 @@
       # It may, however, have been removed by some biber unpacked dists
       if (not exists($ENV{PERL_LWP_SSL_CA_FILE}) and
           not exists($ENV{PERL_LWP_SSL_CA_PATH}) and
-          not defined(Biber::Config->getoption('ssl-nointernalca')) and
-          eval {require Mozilla::CA}) {
-        # we assume that the default CA file is in .../Mozilla/CA/cacert.pem
-        (my $vol, my $dir, undef) = File::Spec->splitpath( $INC{"Mozilla/CA.pm"} );
-        $dir =~ s/\/$//; # splitpath sometimes leaves a trailing '/'
-        $ENV{PERL_LWP_SSL_CA_FILE} = File::Spec->catpath($vol, "$dir/CA", 'cacert.pem');
+          not defined(Biber::Config->getoption('ssl-nointernalca'))) {
+        $ENV{PERL_LWP_SSL_CA_FILE} = '/etc/ssl/certs/ca-certificates.crt';
       }
 
       # fallbacks for, e.g., linux
